<%= render "settings/shared/settings_layout" do %>
  <div class="space-y-6">
    <div>
      <h2 class="text-xl font-semibold text-text-primary">Security</h2>
      <p class="text-sm text-text-secondary mt-1">Manage your password and account security</p>
    </div>

    <%= form_with(model: current_user, url: settings_security_path, method: :patch, class: "space-y-6") do |form| %>
      <% if current_user.errors.any? %>
        <%= render AlertComponent.new(variant: :danger, dismissable: false) do %>
          <div>
            <p class="font-medium"><%= pluralize(current_user.errors.count, "error") %> prevented saving:</p>
            <ul class="mt-1 list-disc list-inside text-sm">
              <% current_user.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
      <% end %>

      <div class="animate-card-entrance stagger-1">
        <%= render CardComponent.new do |card| %>
          <% card.with_header do %>
            <h3 class="text-lg font-semibold text-text-primary">Change Password</h3>
          <% end %>
          <div class="space-y-4">
            <%= render InputComponent.new(
              form: form, field: :current_password, type: :password,
              label: "Current password", required: true, autocomplete: "current-password"
            ) %>
            <%= render InputComponent.new(
              form: form, field: :password, type: :password,
              label: "New password", autocomplete: "new-password",
              hint: "#{@minimum_password_length} characters minimum."
            ) %>
            <%= render InputComponent.new(
              form: form, field: :password_confirmation, type: :password,
              label: "Confirm new password", autocomplete: "new-password"
            ) %>
          </div>
        <% end %>
      </div>

      <div class="flex justify-end">
        <%= render ButtonComponent.new(variant: :primary, submit: true) do %>
          Update Password
        <% end %>
      </div>
    <% end %>

    <%# Two-Factor Authentication placeholder %>
    <div class="animate-card-entrance stagger-2">
      <%= render CardComponent.new do |card| %>
        <% card.with_header do %>
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold text-text-primary">Two-Factor Authentication</h3>
            <%= render BadgeComponent.new(variant: :info) do %>Coming Soon<% end %>
          </div>
        <% end %>
        <p class="text-sm text-text-secondary">Add an extra layer of security to your account with two-factor authentication.</p>
      <% end %>
    </div>

    <%# Active Sessions placeholder %>
    <div class="animate-card-entrance stagger-3">
      <%= render CardComponent.new do |card| %>
        <% card.with_header do %>
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold text-text-primary">Active Sessions</h3>
            <%= render BadgeComponent.new(variant: :info) do %>Coming Soon<% end %>
          </div>
        <% end %>
        <p class="text-sm text-text-secondary">View and manage your active sessions across devices.</p>
      <% end %>
    </div>

    <%# Danger Zone %>
    <div class="animate-card-entrance stagger-4">
      <%= render CardComponent.new do |card| %>
        <% card.with_header do %>
          <h3 class="text-lg font-semibold text-danger-600">Danger Zone</h3>
        <% end %>
        <p class="text-sm text-text-secondary mb-4">Once you delete your account, there is no going back. Please be certain.</p>
        <%= button_to "Delete my account", destroy_account_settings_security_path,
            method: :delete,
            data: { turbo_confirm: "Are you sure you want to delete your account? This action cannot be undone." },
            class: "inline-flex items-center gap-2 rounded-lg font-medium transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-offset-2 px-4 py-2 text-sm bg-danger-600 text-white hover:bg-danger-700 focus:ring-danger-500" %>
      <% end %>
    </div>
  </div>
<% end %>
