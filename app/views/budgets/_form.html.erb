<%= form_with(model: budget, class: "space-y-6") do |form| %>
  <% if budget.errors.any? %>
    <%= render AlertComponent.new(variant: :danger, dismissable: false, timeout: 0) do %>
      <strong><%= pluralize(budget.errors.count, "error") %> prevented this budget from being saved:</strong>
      <ul class="mt-2 list-disc list-inside">
        <% budget.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    <% end %>
  <% end %>

  <%= render InputComponent.new(
    form: form,
    field: :category_id,
    label: "Category",
    type: :select,
    collection: current_user.categories.expense.map { |c| [c.name, c.id] },
    include_blank: "Select expense category"
  ) %>

  <%= render InputComponent.new(form: form, field: :amount, label: "Budget Amount", type: :number, step: "0.01", min: "0.01") %>

  <div class="grid grid-cols-2 gap-4">
    <%= render InputComponent.new(
      form: form,
      field: :month,
      label: "Month",
      type: :select,
      collection: (1..12).map { |m| [Date::MONTHNAMES[m], m] }
    ) %>
    <%= render InputComponent.new(
      form: form,
      field: :year,
      label: "Year",
      type: :select,
      collection: (Date.current.year - 1..Date.current.year + 1).to_a
    ) %>
  </div>

  <%= render ButtonComponent.new(variant: :primary, type: "submit", submit: true) do %>
    <%= budget.persisted? ? "Update Budget" : "Create Budget" %>
  <% end %>
<% end %>
