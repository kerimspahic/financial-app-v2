<div class="space-y-6">
  <%= render PageHeaderComponent.new(title: "Reconcile: #{@account.name}") do |header| %>
    <% header.with_actions do %>
      <%= render ButtonComponent.new(variant: :ghost, href: account_path(@account)) do %>
        Cancel
      <% end %>
    <% end %>
  <% end %>

  <%= render CardComponent.new do %>
    <div class="flex items-center justify-between mb-4">
      <div>
        <p class="text-sm text-text-secondary">Current Balance</p>
        <p class="text-2xl font-bold text-text-primary"><%= number_to_currency(@account.balance) %></p>
      </div>
      <div>
        <p class="text-sm text-text-secondary">Unreconciled</p>
        <p class="text-lg font-semibold text-text-primary"><%= @unreconciled.size %> transactions</p>
      </div>
    </div>
  <% end %>

  <% if @unreconciled.any? %>
    <%= form_tag confirm_reconcile_account_path(@account), method: :patch do %>
      <%= render CardComponent.new do |card| %>
        <% card.with_header do %>
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold text-text-primary">Unreconciled Transactions</h2>
            <%= render CheckboxComponent.new(
              label: "Select all",
              size: :sm,
              data: { action: "change->reconcile#selectAll" }
            ) %>
          </div>
        <% end %>
        <div class="divide-y divide-border" data-controller="reconcile">
          <% @unreconciled.each do |t| %>
            <label class="py-3 flex items-center gap-3 cursor-pointer hover:bg-surface-hover/30 -mx-6 px-6 transition-colors">
              <input type="checkbox" name="transaction_ids[]" value="<%= t.id %>"
                class="w-4 h-4 rounded shrink-0" />
              <div class="flex-1 min-w-0">
                <p class="font-medium text-text-primary text-sm"><%= t.description %></p>
                <p class="text-xs text-text-muted"><%= t.date.strftime("%b %d, %Y") %> &middot; <%= t.category.name %></p>
              </div>
              <p class="font-semibold text-sm <%= amount_color_class(t) %>">
                <%= formatted_amount(t) %>
              </p>
            </label>
          <% end %>
        </div>
        <div class="pt-4 border-t border-border mt-4 flex justify-end">
          <%= render ButtonComponent.new(variant: :primary, type: "submit", submit: true, icon: "check") do %>
            Reconcile Selected
          <% end %>
        </div>
      <% end %>
    <% end %>
  <% else %>
    <%= render CardComponent.new do %>
      <%= render EmptyStateComponent.new(
        title: "All reconciled",
        description: "All transactions in this account have been reconciled.",
        icon: "check-badge"
      ) %>
    <% end %>
  <% end %>
</div>
