<div class="space-y-6">
  <%= render PageHeaderComponent.new(title: "Transactions") do |header| %>
    <% header.with_actions do %>
      <%= render ButtonComponent.new(variant: :primary, href: new_transaction_path, icon: "plus") do %>
        New Transaction
      <% end %>
    <% end %>
  <% end %>

  <!-- Filters -->
  <%= render CardComponent.new(padding: false) do %>
    <div class="p-4">
      <%= form_with url: transactions_path, method: :get, class: "flex flex-wrap gap-4 items-end" do |f| %>
        <div>
          <label class="block text-sm font-medium text-text-primary mb-1">Type</label>
          <select name="transaction_type" class="block rounded-lg border border-input-border bg-input-bg text-text-primary px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-input-focus">
            <option value="" <%= 'selected' unless params[:transaction_type].present? %>>All</option>
            <option value="income" <%= 'selected' if params[:transaction_type] == 'income' %>>Income</option>
            <option value="expense" <%= 'selected' if params[:transaction_type] == 'expense' %>>Expense</option>
            <option value="transfer" <%= 'selected' if params[:transaction_type] == 'transfer' %>>Transfer</option>
          </select>
        </div>
        <%= render ButtonComponent.new(variant: :secondary, type: "submit") do %>
          Filter
        <% end %>
      <% end %>
    </div>
  <% end %>

  <% if @transactions.any? %>
    <%= render CardComponent.new(padding: false) do %>
      <%= render TableComponent.new(hoverable: true) do |table| %>
        <% table.with_header do %>
          <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase">Date</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase">Description</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase">Category</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase">Account</th>
          <th class="px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase">Amount</th>
          <th class="px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase">Actions</th>
        <% end %>
        <% table.with_body do %>
          <% @transactions.each do |t| %>
            <tr class="hover:bg-surface-hover">
              <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary"><%= t.date.strftime("%b %d, %Y") %></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary">
                <%= link_to t.description, transaction_path(t), class: "hover:text-primary-600" %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary"><%= t.category.name %></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary"><%= t.account.name %></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-semibold <%= amount_color_class(t) %>">
                <%= formatted_amount(t) %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-right text-sm">
                <%= link_to "Edit", edit_transaction_path(t), class: "text-primary-600 hover:text-primary-700" %>
              </td>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    <% end %>

    <%= render "shared/pagination", pagy: @pagy %>
  <% else %>
    <%= render CardComponent.new do %>
      <%= render EmptyStateComponent.new(
        title: "No transactions found",
        description: "Add your first transaction to start tracking.",
        icon: "banknotes",
        action_text: "Add Transaction",
        action_url: new_transaction_path
      ) %>
    <% end %>
  <% end %>
</div>
