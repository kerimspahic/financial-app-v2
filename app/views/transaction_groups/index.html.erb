<div class="space-y-5">
  <%= render PageHeaderComponent.new(title: "Transaction Groups", subtitle: "Group related transactions together") do |header| %>
    <% header.with_actions do %>
      <div class="flex items-center gap-2">
        <%= render ButtonComponent.new(variant: :secondary, href: transactions_path, icon: "arrow-left", size: :sm) do %>
          Back to Transactions
        <% end %>
        <%= render ButtonComponent.new(variant: :primary, href: new_transaction_group_path, icon: "plus", data: { turbo_frame: "modal" }) do %>
          New Group
        <% end %>
      </div>
    <% end %>
  <% end %>

  <% if @transaction_groups.any? %>
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      <% @transaction_groups.each_with_index do |group, i| %>
        <div class="animate-card-entrance" style="animation-delay: <%= i * 50 %>ms">
          <%= render CardComponent.new do %>
            <div class="space-y-3">
              <div class="flex items-start justify-between">
                <div class="flex items-center gap-2">
                  <% display = group.type_display %>
                  <span class="inline-flex items-center justify-center w-8 h-8 rounded-lg <%= display[:bg] %>">
                    <%= heroicon display[:icon], variant: :mini, options: { class: "w-4 h-4 #{display[:text]}" } %>
                  </span>
                  <div>
                    <%= link_to group.name, transaction_group_path(group), class: "text-sm font-semibold text-text-primary hover:text-primary-600 transition-colors" %>
                    <p class="text-xs text-text-muted"><%= group.group_type.humanize %></p>
                  </div>
                </div>
                <%= render ButtonComponent.new(variant: :danger, size: :sm, href: transaction_group_path(group), method: :delete, confirm: "Delete this group? Transactions will be unlinked.", icon: "trash") do %>
                <% end %>
              </div>

              <div class="flex items-center justify-between pt-2 border-t border-glass-border">
                <span class="text-xs text-text-muted"><%= group.transactions.count %> transactions</span>
                <span class="text-sm font-semibold tabular-nums text-text-primary"><%= number_to_currency(group.total_amount) %></span>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  <% else %>
    <%= render CardComponent.new do %>
      <%= render EmptyStateComponent.new(
        title: "No transaction groups",
        description: "Create groups to link related transactions like refunds, reimbursements, or installments.",
        icon: "link",
        action_text: "Create Group",
        action_url: new_transaction_group_path,
        action_data: { turbo_frame: "modal" }
      ) %>
    <% end %>
  <% end %>
</div>
